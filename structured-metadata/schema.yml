openapi: 3.1.0
info:
  title: Cloudinary Structured Metadata API
  version: 0.3.5
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  contact:
    name: Cloudinary Support
    email: support@cloudinary.com
    url: https://support.cloudinary.com
  termsOfService: https://cloudinary.com/tou
servers:
  - url: https://{region}.cloudinary.com
    description: Regional API endpoints for optimal performance.
    variables:
      region:
        default: api
        description: Regional endpoint selection
        enum:
          - api
          - api-eu
          - api-ap
  - url: https://{host}
    description: Custom domains for enterprise deployments.
    variables:
      host:
        default: api.cloudinary.com
        description: API host domain.
security:
  - basicAuth: []
  - oauth2:
      - asset_management
      - upload
tags:
  - name: metadata_fields
    description: Enables you to manage structured metadata fields.
  - name: metadata_rules
    description: Enables you to set up dependencies and relationships between structured metadata fields and options.
paths:
  /v1_1/{cloud_name}/metadata_fields:
    parameters:
      - $ref: '#/components/parameters/cloud_name'
    post:
      x-speakeasy-mcp:
        name: create-metadata-field
        scopes:
          - admin
        title: Create Metadata Field
      operationId: createMetadataField
      summary: Creates a new structured metadata field in your account
      description: Creates a new metadata field with the specified properties and configuration.
      tags:
        - metadata_fields
      responses:
        '200':
          description: metadata field created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/metadata_field'
        '400':
          description: validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '403':
          description: insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/metadata_field'
    get:
      x-speakeasy-mcp:
        name: list-metadata-fields
        scopes:
          - builder
        title: List Metadata Fields
        readOnlyHint: true
        idempotentHint: true
      operationId: listMetadataFields
      summary: Lists all structured metadata fields defined in your Cloudinary product environment
      description: Retrieves a list of all metadata fields in the product environment based on the provided filters.
      tags:
        - metadata_fields
      parameters:
        - name: external_ids
          in: query
          required: false
          schema:
            type: array
            items:
              type: string
          description: The external IDs of the metadata fields to retrieve. if not provided, all metadata fields will be returned.
      responses:
        '200':
          description: metadata fields retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  metadata_fields:
                    type: array
                    items:
                      $ref: '#/components/schemas/metadata_field'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '403':
          description: insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
  /v1_1/{cloud_name}/metadata_fields/{external_id}:
    parameters:
      - $ref: '#/components/parameters/cloud_name'
      - name: external_id
        in: path
        required: true
        schema:
          type: string
        description: The external ID of the metadata field to retrieve.
    get:
      x-speakeasy-mcp:
        name: get-metadata-field
        scopes:
          - admin
        title: Get Metadata Field
        readOnlyHint: true
        idempotentHint: true
      operationId: getMetadataField
      summary: Retrieves the definition of a specific structured metadata field by its identifier (external_id)
      description: Retrieves detailed information about the specified metadata field.
      tags:
        - metadata_fields
      responses:
        '200':
          description: metadata field retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/metadata_field'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '403':
          description: insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '404':
          description: metadata field not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
    put:
      x-speakeasy-mcp:
        name: update-metadata-field
        scopes:
          - admin
        title: Update Metadata Field
        idempotentHint: true
      operationId: updateMetadataField
      summary: Updates the configuration of an existing metadata field
      description: Updates the properties and configuration of the specified metadata field.
      tags:
        - metadata_fields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/metadata_field'
      responses:
        '200':
          description: metadata field updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/metadata_field'
        '400':
          description: validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '403':
          description: insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '404':
          description: metadata field not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
    delete:
      x-speakeasy-mcp:
        name: delete-metadata-field
        scopes:
          - builder
        title: Delete Metadata Field
        destructiveHint: true
        idempotentHint: true
      operationId: deleteMetadataField
      summary: Deletes a structured metadata field definition from your account
      description: Permanently deletes the specified metadata field and all its associated data.
      tags:
        - metadata_fields
      responses:
        '200':
          description: metadata field deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                required:
                  - message
        '400':
          description: validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '403':
          description: insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '404':
          description: metadata field not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
  /v1_1/{cloud_name}/metadata_fields/datasource/search:
    parameters:
      - $ref: '#/components/parameters/cloud_name'
    post:
      operationId: searchMetadataFieldDatasource
      summary: Search across all metadata field datasources
      description: Performs a search across all metadata field datasources to find matching values.
      tags:
        - metadata_fields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                term:
                  type: string
                  description: The term to search for. Can be any substring of the value.
                max_results:
                  type: integer
                  default: 100
                  description: The maximum number of results to return.
      responses:
        '200':
          description: search results
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    field_id:
                      type: string
                      description: The external ID of the metadata field.
                    id:
                      type: string
                      description: The external ID of the option.
                    value:
                      type: string
                      description: The value of the option.
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
  /v1_1/{cloud_name}/metadata_fields/order:
    parameters:
      - $ref: '#/components/parameters/cloud_name'
    put:
      operationId: reorderMetadataFields
      summary: Reorder all metadata fields
      description: Changes the display order of all metadata fields based on specified criteria.
      tags:
        - metadata_fields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                order_by:
                  type: string
                  enum:
                    - label
                    - created_at
                    - external_id
                  description: The field to order by.
                direction:
                  type: string
                  enum:
                    - asc
                    - desc
                  description: The direction to order by.
              required:
                - order_by
      responses:
        '200':
          description: metadata fields reordered
          content:
            application/json:
              schema:
                type: object
                properties:
                  metadata_fields:
                    type: array
                    items:
                      $ref: '#/components/schemas/metadata_field'
        '400':
          description: invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
  /v1_1/{cloud_name}/metadata_fields/{external_id}/reorder:
    parameters:
      - $ref: '#/components/parameters/cloud_name'
      - name: external_id
        in: path
        required: true
        schema:
          type: string
        description: The external ID of the metadata field to reorder.
    put:
      operationId: reorderMetadataField
      summary: Change position of metadata field
      description: Changes the display position of a specific metadata field within the list.
      tags:
        - metadata_fields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                position:
                  type: integer
                  description: The position of the metadata field.
              required:
                - position
      responses:
        '200':
          description: metadata fields reordered
          content:
            application/json:
              schema:
                type: object
                properties:
                  metadata_fields:
                    type: array
                    items:
                      $ref: '#/components/schemas/metadata_field'
        '400':
          description: invalid position
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '404':
          description: metadata field not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
  /v1_1/{cloud_name}/metadata_fields/{external_id}/datasource:
    parameters:
      - $ref: '#/components/parameters/cloud_name'
      - name: external_id
        in: path
        required: true
        schema:
          type: string
        description: The external ID of the metadata field to update the datasource for.
    put:
      x-speakeasy-mcp:
        name: update-metadata-datasource-values
        scopes:
          - builder
        title: Update Metadata Datasource Values
        idempotentHint: true
      operationId: updateMetadataFieldDatasource
      summary: Updates the allowed values (the datasource) for a specified metadata field
      description: Updates the values in a metadata field's datasource, including adding, modifying, or changing the order of values.
      tags:
        - metadata_fields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                values:
                  type: array
                  items:
                    type: object
                    properties:
                      external_id:
                        type: string
                        description: The external ID of the datasource value.
                      value:
                        type: string
                        description: The value of the option.
                      position:
                        type: integer
                        description: The position of the option.
                      state:
                        type: string
                        enum:
                          - active
                          - inactive
                        description: The state of the option.
      responses:
        '200':
          description: datasource updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  values:
                    type: array
                    items:
                      $ref: '#/components/schemas/metadata_field_datasource_value'
        '400':
          description: invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '404':
          description: metadata field not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
    delete:
      x-speakeasy-mcp:
        name: delete-metadata-datasource-values
        scopes:
          - builder
        title: Delete Metadata Datasource Values
        destructiveHint: true
        idempotentHint: true
      operationId: deleteMetadataFieldDatasource
      summary: Removes one or more allowed values from a metadata field's datasource
      description: Removes specific values from a metadata field's datasource by their external IDs.
      tags:
        - metadata_fields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                external_ids:
                  type: array
                  items:
                    type: string
                  description: The external IDs of the datasource values to delete.
              required:
                - external_ids
      responses:
        '200':
          description: datasource values deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/metadata_field_datasource_values_array'
        '400':
          description: invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '404':
          description: metadata field not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
  /v1_1/{cloud_name}/metadata_fields/{external_id}/datasource/search:
    parameters:
      - $ref: '#/components/parameters/cloud_name'
      - name: external_id
        in: path
        required: true
        schema:
          type: string
        description: The external ID of the metadata field to search the datasource for.
    post:
      operationId: searchDatasourceInMDField
      summary: Search datasource values in a metadata field
      description: Performs a search within a specific metadata field's datasource to find matching values, with support for exact or partial matches.
      tags:
        - metadata_fields
      parameters:
        - name: max_results
          in: query
          required: false
          schema:
            type: integer
            default: 255
          description: The maximum number of results to return.
        - name: term
          in: query
          required: false
          schema:
            type: string
          description: The term to search for. can be any substring of the value.
        - name: exact_match
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: Whether to search for an exact match.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                payload:
                  type: object
                  description: Metadata payload for rule-based inference
      responses:
        '200':
          description: search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/metadata_field_datasource_values_array'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '404':
          description: metadata field not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
  /v1_1/{cloud_name}/metadata_fields/{external_id}/datasource_restore:
    parameters:
      - $ref: '#/components/parameters/cloud_name'
      - name: external_id
        in: path
        required: true
        schema:
          type: string
        description: The external ID of the metadata field to restore the datasource values for.
    post:
      operationId: restoreMetadataFieldDatasource
      summary: Restore datasource values
      description: Restores datasource values that have been deleted.
      tags:
        - metadata_fields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                external_ids:
                  type: array
                  items:
                    type: string
                  description: The external IDs of the datasource values to restore.
      responses:
        '200':
          description: datasource values restored
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/metadata_field_datasource_values_array'
        '400':
          description: invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '403':
          description: insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '404':
          description: metadata field not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
  /v1_1/{cloud_name}/metadata_rules:
    parameters:
      - $ref: '#/components/parameters/cloud_name'
    post:
      x-speakeasy-mcp:
        name: create-metadata-rule
        scopes:
          - builder
        title: Create Metadata Rule
      operationId: createMetadataRule
      summary: Creates a new conditional metadata rule
      description: Creates a new metadata rule with the specified properties and configuration.
      tags:
        - metadata_rules
      responses:
        '200':
          description: metadata rule created.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/metadata_rule_response'
        '400':
          description: validation error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '403':
          description: insufficient permissions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/metadata_rule_create'
    get:
      x-speakeasy-mcp:
        name: list-metadata-rules
        scopes:
          - builder
        title: List Metadata Rules
        readOnlyHint: true
        idempotentHint: true
      operationId: listMetadataRules
      summary: Retrieves a list of all conditional metadata rules defined in your accountcloudinary
      description: Retrieves a list of all metadata rules in the cloud.
      tags:
        - metadata_rules
      responses:
        '200':
          description: metadata rules retrieved.
          content:
            application/json:
              schema:
                type: object
                properties:
                  metadata_rules:
                    type: array
                    items:
                      $ref: '#/components/schemas/metadata_rule_response'
        '401':
          description: authentication error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '403':
          description: insufficient permissions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
  /v1_1/{cloud_name}/metadata_rules/{external_id}:
    parameters:
      - $ref: '#/components/parameters/cloud_name'
      - name: external_id
        in: path
        required: true
        schema:
          type: string
        description: The unique identifier of the metadata rule.
    put:
      x-speakeasy-mcp:
        name: update-metadata-rule
        scopes:
          - builder
        title: Update Metadata Rule
        idempotentHint: true
      operationId: updateMetadataRule
      summary: Updates an existing conditional metadata rule's definition
      description: Updates the properties and configuration of an existing metadata rule.
      tags:
        - metadata_rules
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/metadata_rule_update'
      responses:
        '200':
          description: metadata rule updated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/metadata_rule_response'
        '400':
          description: validation error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '403':
          description: insufficient permissions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '404':
          description: metadata rule not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
    delete:
      x-speakeasy-mcp:
        name: delete-metadata-rule
        scopes:
          - builder
        title: Delete Metadata Rule
        destructiveHint: true
        idempotentHint: true
      operationId: deleteMetadataRule
      summary: Deletes a conditional metadata rule by its ID
      description: Permanently deletes a metadata rule.
      tags:
        - metadata_rules
      responses:
        '200':
          description: metadata rule deleted.
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                required:
                  - success
        '400':
          description: validation error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '401':
          description: authentication error.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '403':
          description: insufficient permissions.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
        '404':
          description: metadata rule not found.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/api_error'
components:
  securitySchemes:
    basicAuth:
      type: http
      scheme: basic
    oauth2:
      type: oauth2
      description: OAuth2 Authorization Code flow for user authentication
      flows:
        authorizationCode:
          authorizationUrl: https://oauth.cloudinary.com/oauth2/auth
          tokenUrl: https://oauth.cloudinary.com/oauth2/token
          scopes:
            asset_management: Allows managing assets, including reading, updating, and deleting.
            upload: Allows uploading new assets.
  parameters:
    cloud_name:
      name: cloud_name
      in: path
      required: true
      schema:
        type: string
        description: The cloud name of your product environment.
  schemas:
    metadata_field:
      type: object
      properties:
        type:
          type: string
          enum:
            - string
            - integer
            - date
            - enum
            - set
          description: The type of the metadata field.
        external_id:
          type: string
          maxLength: 255
          description: The external ID of the metadata field.
        label:
          type: string
          maxLength: 255
          description: The label of the metadata field.
        mandatory:
          type:
            - boolean
            - 'null'
          description: Whether the metadata field is mandatory.
        default_value:
          type:
            - string
            - integer
            - 'null'
          description: The default value of the metadata field.
        default_disabled:
          type:
            - boolean
            - 'null'
          description: Whether the default value is disabled.
        validation:
          type:
            - object
            - 'null'
          description: The validation defined for the metadata field.
        restrictions:
          type:
            - object
            - 'null'
          description: The restrictions defined for the metadata field.
          properties:
            readonly_ui:
              type: boolean
              description: Whether the metadata field is read-only in the UI. when true, the metadata field can only be updated via the API.
        datasource:
          type:
            - object
            - 'null'
          description: The datasource defined for the metadata field.
          properties:
            values:
              type: array
              items:
                type: object
                properties:
                  external_id:
                    type: string
                    description: The external ID of the option.
                  value:
                    type: string
                    description: The value of the option.
                  position:
                    type: integer
                    description: The position of the option.
                  state:
                    type: string
                    enum:
                      - active
                      - inactive
                    description: The state of the option.
        allow_dynamic_list_values:
          type:
            - boolean
            - 'null'
          description: Whether the metadata field allows adding new options to the datasource dynamically.
      required:
        - type
        - label
    api_error:
      type: object
      properties:
        error:
          type: object
          properties:
            message:
              type: string
          required:
            - message
      required:
        - error
    metadata_field_datasource_value:
      type: object
      properties:
        external_id:
          type: string
          description: The external ID of the datasource value.
        value:
          type: string
          description: The value of the option.
    metadata_field_datasource_values_array:
      type: object
      properties:
        values:
          type: array
          items:
            $ref: '#/components/schemas/metadata_field_datasource_value'
    metadata_rule_base:
      type: object
      properties:
        metadata_field_id:
          type: string
          description: The ID of the metadata field this rule applies to.
        name:
          type: string
          description: A descriptive name for the metadata rule.
        condition:
          type: object
          description: The condition that triggers this rule. Ensure it adheres to the metadata rule condition schema.
        result:
          type: object
          description: The result to apply when the condition is met, should adhere to the metadata rule result schema.
        state:
          type: string
          enum:
            - active
            - inactive
          description: The state of the rule.
        position:
          type: integer
          description: The position/order of this rule relative to other rules.
      example:
        metadata_field_id: smd-field-1
        name: My Rule
        condition:
          metadata_field_id: smd-field-2
          populated: true
        result:
          apply_value:
            value: my value
            mode: default
        state: active
        position: 1
    metadata_rule_response:
      allOf:
        - $ref: '#/components/schemas/metadata_rule_base'
        - type: object
          properties:
            external_id:
              type: string
              description: The unique identifier of the metadata rule.
            condition_signature:
              type: string
              description: A signature representing the condition structure.
      example:
        external_id: '1234567890'
        metadata_field_id: smd-field-1
        name: My Rule
        condition:
          metadata_field_id: smd-field-2
          populated: true
        condition_signature: dGhlIGZveCBqdW1wZWQgb3ZlciB0aGUgbGF6eSBkb2c
        result:
          apply_value:
            value: my value
            mode: default
        state: active
        position: 1
    metadata_rule_create:
      allOf:
        - $ref: '#/components/schemas/metadata_rule_base'
      required:
        - metadata_field_id
        - name
        - condition
        - result
      example:
        metadata_field_id: smd-field-1
        name: My Rule
        condition:
          metadata_field_id: smd-field-2
          populated: true
        result:
          apply_value:
            value: my value
            mode: default
        state: active
        position: 1
    metadata_rule_update:
      allOf:
        - $ref: '#/components/schemas/metadata_rule_base'
      example:
        metadata_field_id: smd-field-1
        name: My Rule
        condition:
          metadata_field_id: smd-field-2
          populated: true
        result:
          apply_value:
            value: my value
            mode: default
        state: active
        position: 1
x-speakeasy-globals:
  parameters: null
